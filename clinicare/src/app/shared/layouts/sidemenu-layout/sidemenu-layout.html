@if (loggedUser() !== null) {

<div
  class="overflow-y-scroll w-screen h-screen antialiased text-slate-300 selection:bg-blue-600 selection:text-white"
>
  <!-- Botón móvil -->
  <button
    class="md:hidden fixed top-4 left-4 z-20 btn btn-primary"
    (click)="toggleMobileMenu()"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      class="h-6 w-6"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
      stroke-width="2"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M4 6h16M4 12h16M4 18h16"
      />
    </svg>
  </button>

  <!-- Sidebar -->
  <aside class="hidden md:flex md:flex-col md:fixed md:w-72">
    <div
      class="min-h-screen w-72 bg-[#D4E0FF] dark:bg-[#151C33] border-r border-gray-700 pt-4"
    >
      <div id="logo" class="my-4 px-6">
        <h1
          class="text-2xl font-montserrat flex justify-center cursor-pointer mt-10"
          [routerLink]="['/']"
        >
          <span class="font-serif italic font-bold text-[rgb(72,184,75,1)]"
            >Clini</span
          >
          <span class="font-serif italic font-bold text-[rgb(0,154,255,1)]"
            >Care</span
          >
        </h1>
        <!-- Texto dinamico del layout por rol -->
        <p class="dark:text-gray-200 text-gray-800 text-sm text-center">
          @if (loggedUser()?.roles?.[0] === USER_ROLE.ADMIN) {
          <!--  -->
          Administra Clinicare de manera eficiente Administra tus Pacientes y
          Citas de manera eficiente
          <!--  -->
          }
          <!--  -->
          @if (loggedUser()?.roles?.[0] === USER_ROLE.DOCTOR) {
          <!--  -->
          Administra tus Pacientes y Gestiona tus Citas

          <!--  -->
          }
          <!--  -->
          @if (loggedUser()?.roles?.[0] === USER_ROLE.PATIENT) {
          <!--  -->
          Gestiona tus citas médicas de forma sencilla
          <!--  -->
          }
        </p>
      </div>
      <div id="profile" class="px-6 pb-10">
        @if (loggedUser()?.profile_user_image) {
        <img
          class="size-24 rounded-full mx-auto mb-3 object-cover cursor-pointer transition-transform duration-300 ease-in-out hover:scale-105 origin-center"
          [src]="loggedUser()?.profile_user_image"
          (click)="abrirModal(loggedUser()!.profile_user_image!)"
        />
        } @else {
        <div class="divider my-4"></div>
        }
        <p class="dark:text-gray-200 text-gray-800 text-center">
          @if (loggedUser()?.gender === USER_GENDER.MALE) {
          <!--  -->
          ¡Bienvenido!
          <!--  -->
          } @else {
          <!--  -->
          ¡Bienvenida!
          <!--  -->
          }
        </p>
        <p class="text-primary font-bold text-center">
          <!--  -->
          @if(loggedUser()?.roles?.[0] === USER_ROLE.DOCTOR) {
          <!--  -->
          @if (loggedUser()?.gender === USER_GENDER.MALE) {
          <span> Dr.</span>
          } @else {
          <span> Dra.</span>
          }
          <!--  -->
          }
          <!--  -->
          {{ loggedUser()?.name }} {{ loggedUser()?.last_name }}
        </p>

        <!-- Editar perfil -->
        @if (loggedUser()?.roles?.[0] !== USER_ROLE.ADMIN) {
        <button
          class="btn btn-soft btn-success mt-4 w-full"
          [routerLink]="['/update-user']"
        >
          Edita tu perfil <edit-icon [size]="18" />
        </button>
        }

        <!-- Especialidad si es doctor -->
        @if (loggedUser()?.doctor_specialty !== null) {
        <div class="divider my-2"></div>

        <p class="dark:text-gray-200 text-gray-800 text-center">
          Tu especialidad es
        </p>
        <p class="text-secondary font-bold text-center">
          {{ loggedUser()?.doctor_specialty }}
        </p>
        }
      </div>
      <div id="nav" class="w-full px-6">
        @if (loggedUser()?.roles?.[0] === USER_ROLE.ADMIN) {
        <!--  -->
        <admin-side-menu-items />
        <!--  -->
        }
        <!--  -->
        @if (loggedUser()?.roles?.[0] === USER_ROLE.DOCTOR) {
        <!--  -->
        <doctor-side-menu-items />
        <!--  -->
        }
        <!--  -->
        @if (loggedUser()?.roles?.[0] === USER_ROLE.PATIENT) {
        <!--  -->
        <patient-side-menu-items />
        <!--  -->
        }
        <div class="divider my-2"></div>
        <div class="flex flex-col gap-3">
          <button class="btn btn-secondary w-full" [routerLink]="['/']">
            Volver al inicio
          </button>
          <button class="btn btn-error w-full" (click)="authService.logout()">
            Cerrar Sesión
          </button>
        </div>
      </div>
    </div>
  </aside>

  <!-- Sidebar móvil -->
  <aside
    class="fixed top-0 left-0 z-50 h-screen w-64 bg-[#D4E0FF] dark:bg-[#151C33] backdrop-blur-lg border-r border-gray-700 pt-4 md:hidden transform transition-transform duration-500 ease-[cubic-bezier(0.16,1,0.3,1)]"
    [class.translate-x-0]="mobileMenuOpen"
    [class.-translate-x-full]="!mobileMenuOpen"
  >
    <div id="menu" class="min-h-screen w-full">
      <div id="logo" class="my-4 px-6">
        <h1
          class="text-2xl font-montserrat flex justify-center cursor-pointer mt-10"
          [routerLink]="['/']"
        >
          <span class="font-serif italic font-bold text-[rgb(72,184,75,1)]"
            >Clini</span
          >
          <span class="font-serif italic font-bold text-[rgb(0,154,255,1)]"
            >Care</span
          >
        </h1>
        <!-- Texto dinamico del layout por rol -->
        <p class="dark:text-gray-200 text-gray-800 text-sm text-center">
          @if (loggedUser()?.roles?.[0] === USER_ROLE.ADMIN) {
          <!--  -->
          Administra Clinicare de manera eficiente Administra tus Pacientes y
          Citas de manera eficiente
          <!--  -->
          }
          <!--  -->
          @if (loggedUser()?.roles?.[0] === USER_ROLE.DOCTOR) {
          <!--  -->
          Administra tus Pacientes y Citas de manera eficiente

          <!--  -->
          }
          <!--  -->
          @if (loggedUser()?.roles?.[0] === USER_ROLE.PATIENT) {
          <!--  -->
          Gestiona tus citas médicas de forma sencilla
          <!--  -->
          }
        </p>
      </div>
      <div id="profile" class="px-6">
        @if (loggedUser()?.profile_user_image) {
        <img
          class="size-24 rounded-full mx-auto mb-3 object-cover cursor-pointer transition-transform duration-300 ease-in-out hover:scale-105 origin-center"
          [alt]="loggedUser()?.name + ' ' + loggedUser()?.last_name"
          [src]="loggedUser()?.profile_user_image"
          (click)="abrirModal(loggedUser()!.profile_user_image!)"
        />
        } @else {
        <div class="divider my-4"></div>
        }
        <p class="dark:text-gray-200 text-gray-800 text-center">
          @if (loggedUser()?.gender === USER_GENDER.MALE) {
          <!--  -->
          ¡Bienvenido!
          <!--  -->
          } @else {
          <!--  -->
          ¡Bienvenida!
          <!--  -->
          }
        </p>
        <p class="text-primary font-bold text-center">
          <!--  -->
          @if(loggedUser()?.roles?.[0] === USER_ROLE.DOCTOR) {
          <!--  -->
          @if (loggedUser()?.gender === USER_GENDER.MALE) {
          <span> Dr.</span>
          } @else {
          <span> Dra.</span>
          }
          <!--  -->
          }
          <!--  -->
          {{ loggedUser()?.name }} {{ loggedUser()?.last_name }}
        </p>

        <!-- Editar perfil -->
        @if (loggedUser()?.roles?.[0] !== USER_ROLE.ADMIN) {
        <button
          class="btn btn-soft btn-success my-4 w-full"
          [routerLink]="['/update-user']"
        >
          Edita tu perfil <edit-icon [size]="18" />
        </button>
        }

        <!-- Especialidad si es doctor -->
        @if (loggedUser()?.doctor_specialty !== null) {
        <div class="divider my-2"></div>

        <p class="dark:text-gray-200 text-gray-800 text-center">
          Tu especialidad es
        </p>
        <p class="text-secondary font-bold text-center">
          {{ loggedUser()?.doctor_specialty }}
        </p>
        }
      </div>
      <div id="nav" class="w-full px-6">
        @if (loggedUser()?.roles?.[0] === USER_ROLE.ADMIN) {
        <!--  -->
        <admin-side-menu-items />
        <!--  -->
        }
        <!--  -->
        @if (loggedUser()?.roles?.[0] === USER_ROLE.DOCTOR) {
        <!--  -->
        <doctor-side-menu-items />
        <!--  -->
        }
        <!--  -->
        @if (loggedUser()?.roles?.[0] === USER_ROLE.PATIENT) {
        <!--  -->
        <patient-side-menu-items />
        <!--  -->
        }
        <div class="divider my-2"></div>
        <div class="flex flex-col gap-3">
          <button class="btn btn-secondary w-full" [routerLink]="['/']">
            Volver al inicio
          </button>
          <button class="btn btn-error w-full" (click)="authService.logout()">
            Cerrar Sesión
          </button>
        </div>
      </div>
    </div>
  </aside>

  <!-- Overlay móvil -->
  <div
    class="fixed inset-0 z-40 bg-black/40 backdrop-blur-xl transition-opacity duration-500 md:hidden"
    [class.opacity-100]="mobileMenuOpen"
    [class.opacity-0]="!mobileMenuOpen"
    [class.visible]="mobileMenuOpen"
    [class.invisible]="!mobileMenuOpen"
    (click)="toggleMobileMenu()"
  ></div>

  <main class="flex-1 md:ml-72 px-6 my-10">
    <router-outlet />
  </main>
</div>
}

<!-- Imagen Modal -->
@if (imagenSeleccionada()) {
<div
  class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 transition-opacity duration-300"
  (click)="cerrarModal()"
>
  <div
    class="relative bg-gradient-to-b rounded-2xl from-base-200 to-base-300 flex flex-col items-center shadow-xl shadow-indigo-900/50 mx-4"
    (click)="$event.stopPropagation()"
  >
    <!-- Botón cerrar -->
    <button
      class="absolute top-6 right-6 bg-black/60 rounded-full size-8 md:size-10 md:text-3xl text-lg font-bold flex items-center justify-center"
      (click)="cerrarModal()"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        height="24px"
        viewBox="0 -960 960 960"
        width="24px"
        fill="#ffffff"
      >
        <path
          d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"
        />
      </svg>
    </button>

    <img
      [src]="imagenSeleccionada()"
      alt="Imagen seleccionada"
      class="max-h-[80vh] object-contain rounded-lg select-none"
    />
  </div>
</div>
}
